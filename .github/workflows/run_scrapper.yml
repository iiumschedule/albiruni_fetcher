name: Run scrapper script

"on":
  workflow_dispatch:
    inputs:
      session:
        description: "Academic session"
        default: "2022/2023"
        required: true
        type: string
      semester:
        description: "Semester"
        default: 1
        required: true
        type: choice
        options:
          - 1
          - 2
          - 3

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup Dart SDK
        id: setup-dart-sdk
        uses: dart-lang/setup-dart@v1.4

      - name: Install dependencies
        run: dart pub get

      - name: Run scrapper
        run: dart bin/albiruni_fetcher.dart --session ${{ inputs.session }} --sem ${{ inputs.semester }}

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "ğŸ—ƒï¸ update DB"
          title: "ğŸ—ƒï¸ update DB"
          body: "Scrap job for **session ${{ inputs.session }}** and **semester ${{ inputs.semester }}**"
          branch: update/db
          base: master

      - run: echo "Job completed successfully. Using **Dart ${{ steps.setup-dart-sdk.outputs.dart-version }}**"

      - run: echo "Scrap job for **session ${{ inputs.session }}** and **semester ${{ inputs.semester }}**"
